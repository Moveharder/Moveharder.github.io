import{_ as s,c as i,o as a,a2 as n}from"./chunks/framework.lL4UzoDo.js";const g=JSON.parse('{"title":"Chromeæ’ä»¶-è¸©å‘","description":"","frontmatter":{},"headers":[],"relativePath":"æµè§ˆå™¨ç›¸å…³/chromeæ’ä»¶/è¸©å‘.md","filePath":"æµè§ˆå™¨ç›¸å…³/chromeæ’ä»¶/è¸©å‘.md","lastUpdated":1673315780000}'),t={name:"æµè§ˆå™¨ç›¸å…³/chromeæ’ä»¶/è¸©å‘.md"},e=n(`<h1 id="chromeæ’ä»¶-è¸©å‘" tabindex="-1">Chromeæ’ä»¶-è¸©å‘ <a class="header-anchor" href="#chromeæ’ä»¶-è¸©å‘" aria-label="Permalink to &quot;Chromeæ’ä»¶-è¸©å‘&quot;">â€‹</a></h1><p>æœ¬ç¯‡æ˜¯å¯¹å¼€å‘Chromeæ’ä»¶å¼€å‘è¿‡ç¨‹ä¸­ä¸€äº›åŠŸèƒ½å®ç°æ‰€éœ€åˆ°çš„é—®é¢˜è¿›è¡Œæ¢³ç†æ€»ç»“ï¼Œå¦‚ï¼šæ–‡ä»¶çš„é€šä¿¡ã€æ’ä»¶å›¾æ ‡å’ŒbadgeTextçš„åŠ¨æ€è®¾ç½®ï¼Œç­‰ç­‰</p><hr><h2 id="æ’ä»¶åªåœ¨æŒ‡å®šçš„ç½‘é¡µå¯ç”¨" tabindex="-1">æ’ä»¶åªåœ¨æŒ‡å®šçš„ç½‘é¡µå¯ç”¨ <a class="header-anchor" href="#æ’ä»¶åªåœ¨æŒ‡å®šçš„ç½‘é¡µå¯ç”¨" aria-label="Permalink to &quot;æ’ä»¶åªåœ¨æŒ‡å®šçš„ç½‘é¡µå¯ç”¨&quot;">â€‹</a></h2><blockquote><p>â€œThe Declarative Content API allows you to enable your extension&#39;s action depending on the URL of a web page, or if a CSS selector matches an element on the page, without needing to add host permissions or inject a content script.&quot;</p></blockquote><p>é€šè¿‡<code>Declarative</code>è®¾ç½®URLæˆ–è€…CSSé€‰æ‹©å™¨åŒ¹é…è§„åˆ™ï¼Œå¯ä»¥å®ç°åœ¨ç‰¹å®šçš„ç½‘é¡µå¼€å¯æ’ä»¶åŠŸèƒ½ã€‚</p><p>é¦–å…ˆï¼Œåœ¨manifest.jsonä¸­å£°æ˜<code>permissions</code>å’ŒæŒ‡å®š<code>page_action</code>ã€‚æ³¨æ„ï¼šä¸æ˜¯<code>browser_action</code>ï¼Œå®ƒæ˜¯é’ˆå¯¹æ‰€æœ‰é¡µé¢éƒ½æœ‰æ•ˆçš„ä¸€ç§è®¾ç½®å›¾æ ‡çš„æ–¹å¼ï¼Œä¸æ”¯æŒæŒ‡å®šURLæœ‰æ•ˆã€‚</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;page_action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;default_popup&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;popup.html&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;default_icon&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;16&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;images/icon_16.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;32&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;images/icon_32.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;48&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;images/icon_48.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;images/icon_128.png&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;declarativeContent&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç„¶åï¼Œåœ¨<code>background.js</code>ä¸­è°ƒç”¨<code>chrome.declarativeContent</code>APIè¿›è¡Œæ§åˆ¶ã€‚</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chrome.runtime.onInstalled.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chrome.declarativeContent.onPageChanged.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeRules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">undefined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chrome.declarativeContent.onPageChanged.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addRules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      conditions: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chrome.declarativeContent.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PageStateMatcher</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pageUrl: {hostEquals: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;developer.chrome.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          actions: [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chrome.declarativeContent.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ShowPageAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><ul><li><p>é€šè¿‡pageUrlæ§åˆ¶</p></li><li><p>é€šè¿‡CSSé€‰æ‹©å™¨æ§åˆ¶</p></li></ul><p>å®Œæ•´ä½¿ç”¨å‚è€ƒ <a href="https://developer.chrome.com/docs/extensions/reference/declarativeContent/" target="_blank" rel="noreferrer">æ–‡æ¡£-chrome.declarativeContent</a></p><h2 id="browseractionç›¸å…³æ“ä½œ" tabindex="-1">BrowserActionç›¸å…³æ“ä½œ <a class="header-anchor" href="#browseractionç›¸å…³æ“ä½œ" aria-label="Permalink to &quot;BrowserActionç›¸å…³æ“ä½œ&quot;">â€‹</a></h2><ul><li>è®¾ç½®badgeText</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updateBadgeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">text</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">color</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;#f50000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chrome.browserAction.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setBadgeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ text: text });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chrome.browserAction.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setBadgeBackgroundColor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color: color,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>ä¿®æ”¹icon</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updateActionIcon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">iconPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chrome.browserAction.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setIcon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    path: iconPath,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="æµè§ˆå™¨æ¶ˆæ¯æ°”æ³¡é€šçŸ¥" tabindex="-1">æµè§ˆå™¨æ¶ˆæ¯æ°”æ³¡é€šçŸ¥ <a class="header-anchor" href="#æµè§ˆå™¨æ¶ˆæ¯æ°”æ³¡é€šçŸ¥" aria-label="Permalink to &quot;æµè§ˆå™¨æ¶ˆæ¯æ°”æ³¡é€šçŸ¥&quot;">â€‹</a></h2><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sendNotifications</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">icon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chrome.notifications.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;basic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iconUrl: icon </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;static/img/logo.png&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title: title,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="ä¸åŒæ–‡ä»¶è®¿é—®chromeæ‰©å±•apiçš„é™åˆ¶" tabindex="-1">ä¸åŒæ–‡ä»¶è®¿é—®Chromeæ‰©å±•APIçš„é™åˆ¶ <a class="header-anchor" href="#ä¸åŒæ–‡ä»¶è®¿é—®chromeæ‰©å±•apiçš„é™åˆ¶" aria-label="Permalink to &quot;ä¸åŒæ–‡ä»¶è®¿é—®Chromeæ‰©å±•APIçš„é™åˆ¶&quot;">â€‹</a></h2><blockquote><p>content_scripts</p></blockquote><p>ä½œä¸ºå¯æ³¨å…¥åˆ°è¿è¡Œé¡µé¢çš„è„šæœ¬ï¼ˆè¿˜æœ‰CSSï¼‰ï¼Œå¯è®¿é—®çš„APIæœ€å°‘ï¼Œå¸¸ç”¨çš„æœ‰ä¸‹å‡ ä¸ªï¼š <code>runtimeã€storageã€extensionã€i18n</code>ã€‚ å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>content-scripts</code>å’Œè¿è¡Œé¡µé¢å…±äº«<code>DOM</code>ï¼Œä½†æ˜¯ä¸å…±äº«<code>js</code>ï¼Œå¦‚è¦è®¿é—®é¡µé¢<code>js</code>ï¼ˆä¾‹å¦‚æŸä¸ª<code>js</code>å˜é‡ï¼‰ï¼Œåªèƒ½é€šè¿‡<code>injected js</code>æ¥å®ç°ã€‚</p><blockquote><p>background</p></blockquote><p>æ˜¯ä¸€ä¸ªå¸¸é©»çš„é¡µé¢ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ’ä»¶ä¸­æ‰€æœ‰ç±»å‹é¡µé¢ä¸­æœ€é•¿çš„ï¼Œå®ƒéšç€æµè§ˆå™¨çš„æ‰“å¼€è€Œæ‰“å¼€ï¼Œéšç€æµè§ˆå™¨çš„å…³é—­è€Œå…³é—­ï¼Œæ‰€ä»¥é€šå¸¸æŠŠéœ€è¦ä¸€ç›´è¿è¡Œçš„ã€å¯åŠ¨å°±è¿è¡Œçš„ã€å…¨å±€çš„ä»£ç æ”¾åœ¨backgroundé‡Œé¢ã€‚</p><p>backgroundçš„æƒé™éå¸¸é«˜ï¼Œå‡ ä¹å¯ä»¥è°ƒç”¨æ‰€æœ‰çš„Chromeæ‰©å±•APIï¼Œè€Œä¸”å®ƒå¯ä»¥æ— é™åˆ¶è·¨åŸŸï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è·¨åŸŸè®¿é—®ä»»ä½•ç½‘ç«™è€Œæ— éœ€è¦æ±‚å¯¹æ–¹è®¾ç½®CORSã€‚</p><blockquote><p>popup</p></blockquote><p>å®ƒå’Œbackgroundéå¸¸ç±»ä¼¼ï¼Œå®ƒä»¬ä¹‹é—´æœ€å¤§çš„ä¸åŒæ˜¯ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒï¼Œpopupä¸­å¯ä»¥ç›´æ¥é€šè¿‡chrome.extension.getBackgroundPage()è·å–backgroundçš„windowå¯¹è±¡ã€‚</p><h2 id="é€šä¿¡-ğŸ’¬è¯´-ğŸ‘‚å¬" tabindex="-1">é€šä¿¡ ğŸ’¬è¯´ ğŸ‘‚å¬ <a class="header-anchor" href="#é€šä¿¡-ğŸ’¬è¯´-ğŸ‘‚å¬" aria-label="Permalink to &quot;é€šä¿¡ ğŸ’¬è¯´ ğŸ‘‚å¬&quot;">â€‹</a></h2><h3 id="åœºæ™¯-content-script-jsğŸ’¬-popup-jsğŸ‘‚" tabindex="-1">åœºæ™¯ <code>content_script.js</code>ğŸ’¬ <code>popup.js</code>ğŸ‘‚ <a class="header-anchor" href="#åœºæ™¯-content-script-jsğŸ’¬-popup-jsğŸ‘‚" aria-label="Permalink to &quot;åœºæ™¯ \`content_script.js\`ğŸ’¬ \`popup.js\`ğŸ‘‚&quot;">â€‹</a></h3><blockquote><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨content_scriptç¼–å†™æ’ä»¶ä¸»ä»£ç ï¼Œè¿è¡Œçš„ä¸´æ—¶æ•°æ®éƒ½åœ¨è¿™ç±»jsé‡Œç¼“å­˜ï¼Œå½“ç‚¹å¼€popupé¡µé¢åï¼Œå¦‚ä½•æ‹¿åˆ°è¿™äº›æ•°æ®ï¼Œå¯¹UIè¿›è¡Œæ›´æ–°ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°ä¸¤è€…é€šä¿¡äº†ã€‚</p></blockquote><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// content_script.js å‘popupå‘é€ä¸€æ¡æ¶ˆæ¯ï¼šä¸‹è½½è¿›åº¦</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chrome.runtime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cmd: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;onprogress&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    value: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      domId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      progress,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;æ¥æ”¶åˆ°popup.jsçš„[onprogress]äº‹ä»¶åº”ç­”:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,response);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p><code>popup</code>é€šè¿‡<code>chrome.runtime.onMessage.addListener</code>æ¥æ”¶æ¶ˆæ¯ï¼Œ<code>request</code>æ˜¯æ¶ˆæ¯ä½“ï¼Œè¿™é‡Œç”¨<code>request.cmd</code>æ¥åŒºåˆ†ä¸åŒçš„æ¶ˆæ¯ç±»å‹ã€‚</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// popup.js æ¥æ”¶</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chrome.runtime.onMessage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sendResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cmd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">domId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">progress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {};</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">domId) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (cmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;onprogress&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    updateDownloadBtnUI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domId, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;progress&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, progress);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (cmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;finished&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    updateDownloadBtnUI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domId, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;finished&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (cmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    updateDownloadBtnUI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domId, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  sendResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;æˆ‘æ˜¯popupï¼Œæˆ‘å·²æ”¶åˆ°content_sriptçš„äº‹ä»¶æ¶ˆæ¯ï¼š&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(request)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="åœºæ™¯-content-script-jsğŸ’¬-background-jsğŸ‘‚" tabindex="-1">åœºæ™¯ content_script.jsğŸ’¬ background.jsğŸ‘‚ <a class="header-anchor" href="#åœºæ™¯-content-script-jsğŸ’¬-background-jsğŸ‘‚" aria-label="Permalink to &quot;åœºæ™¯ content_script.jsğŸ’¬  background.jsğŸ‘‚&quot;">â€‹</a></h3><blockquote><p>åŸºæœ¬ä¸Šå’Œ<code>content_script.js</code>ä¸<code>popup.js</code>é€šä¿¡æ–¹å¼ä¸€è‡´ã€‚</p></blockquote><h3 id="åœºæ™¯-popup-jsğŸ’¬-content-script-jsğŸ‘‚" tabindex="-1">åœºæ™¯ popup.jsğŸ’¬ content_script.jsğŸ‘‚ <a class="header-anchor" href="#åœºæ™¯-popup-jsğŸ’¬-content-script-jsğŸ‘‚" aria-label="Permalink to &quot;åœºæ™¯ popup.jsğŸ’¬ content_script.jsğŸ‘‚&quot;">â€‹</a></h3><blockquote><p>å‘é€æ–¹<code>popup.js</code>è·å–å½“å‰<code>tab</code>ï¼Œè°ƒç”¨<code>chrome.tabs.sendMessage</code>å‘é€æ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹<code>content_script.js</code>ä¾ç„¶é€šè¿‡<code>chrome.runtime.onMessage.addListener</code>æ¥æ”¶æ¶ˆæ¯ã€‚</p></blockquote><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// popup.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sendMessageToContentScript</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  chrome.tabs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ active: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, currentWindow: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">tabs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    chrome.tabs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(tabs[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].id, message, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (callback) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(response);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">testBtnDom.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  sendMessageToContentScript</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { cmd: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, value: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;show me the test code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//content_script.js</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chrome.runtime.onMessage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sendResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (request.cmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content_script.state:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, state);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sendResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      msg: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello there&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="åœºæ™¯-popup-jsä¸background-jsé€šä¿¡" tabindex="-1">åœºæ™¯ <code>popup.js</code>ä¸<code>background.js</code>é€šä¿¡ <a class="header-anchor" href="#åœºæ™¯-popup-jsä¸background-jsé€šä¿¡" aria-label="Permalink to &quot;åœºæ™¯ \`popup.js\`ä¸\`background.js\`é€šä¿¡&quot;">â€‹</a></h3><blockquote><p>åœ¨ <code>popup.js</code> ä¸­è°ƒç”¨ <code>background.js</code> ä¸­çš„æ–¹æ³•ã€‚å®é™…ä¸Šæ˜¯é€šè¿‡chrome.extension.getBackgroundPage()è·å–backgroundçš„windowå¯¹è±¡ã€‚</p></blockquote><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>var bg = chrome.extension.getBackgroundPage();</span></span>
<span class="line"><span>bg.doSomething(); //doSomething()æ˜¯backgroundä¸­çš„ä¸€ä¸ªæ–¹æ³•</span></span></code></pre></div><h2 id="v2è¿ç§»v3" tabindex="-1">V2è¿ç§»V3 <a class="header-anchor" href="#v2è¿ç§»v3" aria-label="Permalink to &quot;V2è¿ç§»V3&quot;">â€‹</a></h2><p>ä¸¤ä¸ªç‰ˆæœ¬å·®å¼‚ç‚¹è¿˜æ˜¯æŒºå¤šçš„ï¼Œæ€»çš„æ¥è¯´ï¼Œå¯¹ç›®å‰å¤§éƒ¨åˆ†æ’ä»¶éƒ½æœ‰å½±å“ï¼Œéœ€è¦å¤§é‡å…¼å®¹ã€‚ä»¥ä¸‹åˆ—ä¸¾ä¸€äº›æœ¬äººé‡åˆ°é—®é¢˜ã€‚</p><blockquote><p>å…¨é¢ç¦æ­¢evel</p></blockquote><p>V3æ— æ³•å†é€šè¿‡<code>evel</code>çš„æ–¹å¼è¿è¡Œä»£ç å­—ç¬¦ä¸²äº†ï¼Œæ‰€æœ‰åŠ¨æ€çš„å­—ç¬¦ä¸²ä»£ç å¿…é¡»ä¿å­˜åˆ°æŒ‡å®šçš„<code>js</code>æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨<code>manifest.json</code>æ³¨å†Œè¡¨ä¸­æŒ‡å®šæ–°çš„<code>background</code>ï¼Œä»¥å‰çš„<code>background.scripts</code>æ”¹ä¸º<code>background.service_worker</code>ï¼Œä¸”å€¼ä¸ºå­—ç¬¦ä¸²ã€‚</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;background&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;service_worker&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;background.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><blockquote><p><code>manifest.json</code>æ”¹åŠ¨</p></blockquote><ul><li><code>browser_actionor</code>æˆ–è€…<code>page_action</code>ï¼Œç»Ÿä¸€æ”¹ä¸º<code>action</code>ã€‚ * <code>background.scripts</code>æ”¹ä¸º<code>background.service_worker</code>ã€‚ä¸”service_workerå­—æ®µé‡‡ç”¨å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²æ•°ç»„ã€‚ï¼ˆ<code>service_worker</code>å¿…é¡»åœ¨æ ¹çº§åˆ«æ³¨å†Œï¼šå®ƒä»¬ä¸èƒ½åœ¨åµŒå¥—ç›®å½•ä¸­ã€‚ï¼‰ã€‚</li><li>åœ¨ <code>popup.js</code> ä¸­è°ƒç”¨ <code>background.js</code> ä¸­çš„æ–¹æ³•ï¼Œä»ä¹‹å‰çš„<code>chrome.runtime.getBackgroundPage()</code> æ”¹ä¸º <a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/" target="_blank" rel="noreferrer">backgroundè¿ç§»</a>ã€‚</li><li>web_accessible_resourcesçš„å€¼ä»ä¹‹å‰çš„èµ„æºè·¯å¾„å­—ç¬¦ä¸²æ•°ç»„æ”¹ä¸ºå¯¹è±¡æ•°ç»„ï¼Œä¸”æ¯ä¸ªå¯¹è±¡é…ç½®è‡³å°‘æŒ‡å®šä¸¤ä¸ªå­—æ®µã€‚</li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// V3</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;web_accessible_resources&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;resources&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">RESOURCE_PATHS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;matches&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">MATCH_PATTERNS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;extension_ids&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">EXTENSION_IDS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  optional</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> &quot;use_dynamic_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">boolean</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}]</span></span></code></pre></div><p>å…¶å®ƒä¸€äº›æ²¡é‡åˆ°çš„å°±ä¸åˆ—ä¸¾äº†ï¼Œè¯¦è§ <a href="https://developer.chrome.com/docs/extensions/mv3/mv3-migration-checklist/#api_checklist" target="_blank" rel="noreferrer">mv3-è¿ç§»æ¸…å•</a> å’Œ <a href="https://developer.chrome.com/docs/extensions/mv3/intro/mv3-migration/" target="_blank" rel="noreferrer">mv3-è¿ç§»</a></p>`,51),p=[e];function h(l,k,E,d,r,o){return a(),i("div",null,p)}const y=s(t,[["render",h]]);export{g as __pageData,y as default};
