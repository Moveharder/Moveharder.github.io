import{r as e,G as t,K as a,U as n,c as o,a as i,bt as s,by as r,u as l,bz as c,F as d,ao as h,e as u,S as m,m as p,W as w,a7 as g,aD as f,bo as v,aP as y,A as b,D as x,Q as _,a2 as A,o as P,aq as D,p as C,g as k,n as z,M as I,v as M}from"./vendor.d2781f4b.js";import{_ as S}from"./index.8b78e890.js";const E=e=>(C("data-v-0a689b82"),e=e(),k(),e),F={class:"pick"},q=E((()=>i("div",null,"（^_-）",-1))),R=E((()=>i("option",{value:{}},"选择视频",-1))),W=["value"],$=S({__name:"LedScreen",setup(C){let k=null,S=null,E=null,$=e(null),j=null,B=[{name:"我爱你",src:"https://static.fatiaoya.com/front/believer/resources/videos/iloveu.mp4?v=1",width:130,height:350},{name:"心跳",src:"https://static.fatiaoya.com/front/believer/resources/videos/heart.mp4",width:160,height:200},{name:"赛博人",src:"https://static.fatiaoya.com/front/believer/resources/videos/cyber1.mp4",width:200,height:200},{name:"烟花秀",src:"https://static.fatiaoya.com/front/believer/resources/videos/firework.mp4",width:250,height:140},{name:"美猴王",src:"https://static.fatiaoya.com/front/believer/resources/videos/monkeyking.mp4",width:144,height:256},{name:"狗熊",src:"https://www.runoob.com/try/demo_source/movie.mp4",width:250,height:140}],G=e({}),H=e(!1),L=null;var T=null,U=null;let K=[],Q=new t,V=0,X=0;function Z(){K.length&&J(),j&&j.update(),E.render(k,S),window.requestAnimationFrame(Z)}function J(){new Promise(((e,t)=>{try{const{width:t=0,height:a=0}=L||{};T||((T=document.createElement("canvas")).id="cvideo",T.width=t,T.height=a,T.title="canvas同步视频",U=T.getContext("2d"),T.style.cssText="\n                    position: absolute;\n                    right: 30px;\n                    top: 20px;\n                    border: solid 2px red;\n                "),U.drawImage(L,0,0,t,a),e(U.getImageData(0,0,t,a).data)}catch(a){t({message:"call get_Image_Data error.",error:a})}})).then((e=>{return t=e,new Promise(((e,a)=>{try{let a=[];for(let e=0;e<L.height;e+=4){let n=[];for(let a=0;a<L.width;a+=4){let o=4*(e*L.width+a),i=t[o],s=t[o+1],r=t[o+2];n.push([i,s,r])}a.push(n)}e(a)}catch(n){a({message:"call turnImageData2Pixel error.",err:n})}}));var t})).then((e=>{let t=e.length,a=e[0].length;V||X||(V=t,X=a,function(e,t,a,n,o=.1,i=null){K=[];let s=t*(a+o)-o,r=e*(n+o)-o,l=new z(a,n);for(let c=0;c<e;c++){let e=[];for(let d=0;d<t;d++){let h=new I(l,new M);i&&h.material.color.setRGB(...i[c][t-1-d]);let u=d*a-s/2+o*d+a/2,m=c*n-r/2+o*c+n/2,p=25.04;h.userData={x:u,y:m,z:p},h.position.set(u,m,p),e.push(h),Q.add(h)}K.push(e)}Q.position.set(0,30,0),Q.rotateZ(-Math.PI),k.add(Q)}(V,X,.4,.4,.1));let n=V;for(let o=0;o<n;o++)for(let t=0;t<X;t++)if(e[o]&&e[o][t]){let[a,n,i]=e[o][X-1-t],s=`rgb(${a},${n},${i})`;K[o][t].material.color=new A(s)}}))}function N(e=130,t=350,a="https://xxx.com/video.mp4"){L=function({src:e="",loop:t=!0,muted:a=!1,width:n=640,height:o=480,auto_play:i=!1}){const s=document.createElement("video");if(s.id="source_video",s.src=e,s.loop=t,s.setAttribute("webkit-playsinline",!0),s.setAttribute("playsinline",!0),s.setAttribute("crossorigin","anonymous"),s.muted=a,s.width=n,s.height=o,s.style.cssText="\n        position: absolute;\n        left: 50%;\n        top: 100px;\n        z-index:1001;\n        transform: translateX(-50%);\n    ",i)try{s.play()}catch(r){}return s}({src:a,muted:!1,width:e,height:t});let n=document.querySelector("#source_video");n&&document.body.removeChild(n),document.body.appendChild(L);try{L.play()}catch(o){}Z(),ee()}const O=e=>{const{width:a,height:n,src:o}=G.value;V=0,X=0;try{Q.removeFromParent()}catch(i){}Q=new t,K=[],T=null,U=null,Y(),N(a,n,o)},Y=()=>{L&&(L.pause(),L=null)},ee=()=>{H.value=!0,L&&L.play(),J()};return a((()=>{var e,t;!function(){k=new m;const e="#262837";S=new p(75,window.innerWidth/window.innerHeight,.1,500),S.position.set(0,10,100),E=new w({antialias:!0,logarithmicDepthBuffer:!0}),E.setSize(window.innerWidth,window.innerHeight),E.setPixelRatio(Math.max(window.devicePixelRatio,2)),E.shadowMap.enabled=!0,E.shadowMap.type=g,E.physicallyCorrectLights=!0,E.outputEncoding=f,E.setClearColor(e),E.toneMapping=v,k.fog=new y(e,1,400)}(),function(){const e=new b(16777215,2);k.add(e);const t=new x("#ffffff",1.5);t.position.set(-5,20,10),t.castShadow=!0,k.add(t)}(),$&&(e=S,t=$.value,j=new _(e,t),j.enableDamping=!0,j.minDistance=.01,j.target.set(0,20,0),j.enablePan=!1,j.maxPolarAngle=1.5,j.minPolarAngle=1.5,j.minAzimuthAngle=-.5,j.maxAzimuthAngle=.5,$.value.appendChild(E.domElement))})),n((()=>{Y(),K=[],E.dispose(),window.cancelAnimationFrame(Z)})),(e,t)=>(P(),o("div",null,[i("div",{class:"container",ref_key:"container",ref:$},null,512),i("div",F,[q,s(i("select",{class:"videolist",onChange:O,"onUpdate:modelValue":t[0]||(t[0]=e=>c(G)?G.value=e:G=e)},[R,(P(!0),o(d,null,h(l(B),((e,t)=>(P(),o("option",{key:t,value:e},D(e.name),9,W)))),128)),u("> ")],544),[[r,l(G)]])])]))}},[["__scopeId","data-v-0a689b82"]]);export{$ as default};
