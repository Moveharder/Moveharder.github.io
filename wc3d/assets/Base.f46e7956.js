var t=Object.defineProperty,e=(e,i,s)=>(((e,i,s)=>{i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s})(e,"symbol"!=typeof i?i+"":i,s),s);import{$ as i,a3 as s,V as a,aC as n,S as o,m as r,W as h,a7 as d,aD as l,Q as c,A as u,D as w,af as m,ag as p,I as f,J as g,aE as M,aF as y,x as E,aG as b,M as S,X as x,aH as H}from"./vendor.d2781f4b.js";class C{constructor(t){e(this,"width",window.innerWidth),e(this,"height",window.innerHeight),e(this,"loadingProcess",0),e(this,"sceneReady",!1),e(this,"containerSelector",null),e(this,"container",null),e(this,"scene",null),e(this,"camera",null),e(this,"renderer",null),e(this,"controls",null),e(this,"ground",null),e(this,"stats",null),e(this,"world",null),e(this,"clock",new i),e(this,"oldElapsedTime",0),e(this,"raycaster",new s(new a,new a(0,0,1),0,40)),e(this,"publicPath",{model:"https://static.fatiaoya.com/front/believer/resources/models/",hdr:"hdr/",image:"images/",texture:"images/texture/",sound:"sounds/"}),e(this,"updateGui",(()=>{this.gui&&(this.gui.__controllers.forEach((t=>{t.updateDisplay()})),Object.values(this.gui.__folders).forEach((t=>{t.__controllers.forEach((t=>{t.updateDisplay()}))})))})),this.containerSelector=t,this.initTHREE(),window.onerror=t=>{},n.onStart=function(t,e,i){},n.onLoad=function(){},n.onProgress=function(t,e,i){},n.onError=function(t){}}initTHREE(){const t=new o,e=new r(75,window.innerWidth/window.innerHeight,.1,500);e.position.set(0,6,12),e.lookAt(0,0,0);const i=new h({antialias:!0,logarithmicDepthBuffer:!0});i.setSize(window.innerWidth,window.innerHeight),i.setPixelRatio(Math.max(window.devicePixelRatio,2)),i.shadowMap.enabled=!0,i.shadowMap.type=d,i.physicallyCorrectLights=!0,i.outputEncoding=l,this.scene=t,this.camera=e,this.renderer=i,this.createLight(),this.initStats()}createOrbitControls(t=this.container){let e=new c(this.camera,t);e.enableDamping=!0,e.minDistance=.01,this.controls=e}createLight(){const t=new u("#ffffff",2);this.scene.add(t);const e=new w("#ffffff",1);e.position.set(-5,20,-20),e.castShadow=!0,this.scene.add(e)}addHelpers(){this.createAxesHelper(),this.createGridHelper()}createAxesHelper(t=200){this.scene.add(new m(t))}createGridHelper(t=200,e=200,i,s){this.scene.add(new p(t,e))}createWorld(t=-.98,e=!0){let i=new f;i.boradphase=new g(i),i.allowSleep=!0,i.gravity.set(0,t,0),i.defaultContactMaterial.friction=.2,i.defaultContactMaterial.restitution=.8,this.world=i,e&&this.createWorldMaterial()}createWorldMaterial({friction:t=.2,restitution:e=.6}={}){const i=new M("default"),s=new M("glasic"),a=new y(i,s,{friction:t,restitution:e});this.world.addContactMaterial(a),this.world.defaultContactMaterial=a}createObject(){}createLoadingManager(){const t=new H;t.onProgress=async(t,e,i)=>{100===Math.floor(e/i*100)?(this.loadingProcess=Math.floor(e/i*100),this.sceneReady=!0):this.loadingProcess=Math.floor(e/i*100)},this.loadingManager=t}createRandomCube(t=20,e=4,i=100,s=100,a=5){let n=[];for(let o=0;o<t;o++){let t=Math.ceil(Math.random()*e),o=new E(t,t,t),r=Math.floor(256*Math.random()),h=Math.floor(256*Math.random()),d=Math.floor(256*Math.random()),l=`#${r.toString(16)}${h.toString(16)}${d.toString(16)}`,c=new b({color:l.padEnd(7,0)}),u=new S(o,c),w=this.ground&&this.ground.isMesh?this.ground.geometry.parameters.width:i,m=this.ground&&this.ground.isMesh?this.ground.geometry.parameters.height:s;u.position.x=-w/2+Math.round(Math.random()*w),u.position.y=Math.round(Math.random()*a),u.position.z=-m/2+Math.round(Math.random()*m),n.push(u)}return this.scene.add(...n),n}initStats(){this.stats=new x,this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="0px",this.stats.domElement.style.top="0px",document.body.appendChild(this.stats.domElement)}onResize(){window.addEventListener("resize",(()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}))}animate(){const{scene:t,camera:e,renderer:i,world:s,clock:a,oldElapsedTime:n}=this,o=a.getElapsedTime(),r=o-n;this.oldElapsedTime=o,s&&s.step(1/60,r,3),this.stats&&this.stats.update(),this.update&&this.update(o,r),this.controls&&this.controls.update(),this.composer||i.render(t,e),window.requestAnimationFrame(this.animate.bind(this))}onMounted(){this.container=document.querySelector(this.containerSelector),this.container.appendChild(this.renderer.domElement),this.init&&this.init(),this.onResize(),this.animate()}onUnmounted(){this.hide&&this.hide()}}export{C as B};
